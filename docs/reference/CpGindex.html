<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Measure methylation status for PRCs or PMDs — CpGindex • biscuiteer</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Measure methylation status for PRCs or PMDs — CpGindex" />
<meta property="og:description" content="Measures hypermethylation at PRCs in CGIs or hypomethylation at WCGWs in PMDs" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biscuiteer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/biscuiteer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/trichelab/biscuiteer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Measure methylation status for PRCs or PMDs</h1>
    <small class="dont-index">Source: <a href='https://github.com/trichelab/biscuiteer/blob/master/R/CpGindex.R'><code>R/CpGindex.R</code></a></small>
    <div class="hidden name"><code>CpGindex.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Measures hypermethylation at PRCs in CGIs or hypomethylation at WCGWs in PMDs</p>
    </div>

    <pre class="usage"><span class='fu'>CpGindex</span>(<span class='no'>bsseq</span>, <span class='kw'>CGIs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>PRCs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>WCGW</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>PMDs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>bsseq</th>
      <td><p>A BSseq object</p></td>
    </tr>
    <tr>
      <th>CGIs</th>
      <td><p>A GRanges of CpG island regions - HMM CGIs if NULL
(DEFAULT: NULL)</p></td>
    </tr>
    <tr>
      <th>PRCs</th>
      <td><p>A GRanges of Polycomb targets - H9 state 23 low-meth if NULL
(DEFAULT: NULL)</p></td>
    </tr>
    <tr>
      <th>WCGW</th>
      <td><p>A GRanges of solo-WCGW sites - PMD WCGWs if NULL
(DEFAULT: NULL)</p></td>
    </tr>
    <tr>
      <th>PMDs</th>
      <td><p>A GRanges of hypomethylating regions - PMDs if NULL
(DEFAULT: NULL)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<pre>  A CpGindex (DataFrame w/cols `hyper`, `hypo`, `ratio` + 2 GRs)
</pre>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>At some point in some conference call somewhere, a collaborator suggested
that a simple index of Polycomb repressor complex (PRC) binding site hyper-
methylation and CpG-poor "partially methylated domain" (PMD) hypomethylation
would be a handy yardstick for both deterministic and stochastic changes
associated with proliferation, aging, and cancer. This function provides
such an index by compiling measures of aberrant hyper- and hypo-methylation
along with the ratio of hyper- to hypo-methylation. (The logic for this is
that while the phenomena tend to occur together, there are many exceptions)
The resulting measures can provide a high-level summary of proliferation-,
aging-, and/or disease-associated changes in DNA methylation across samples.</p>
<p>The choice of defaults is fairly straightforward: in 2006, three independent
groups reported recurrent hypermethylation in cancer at sites marked by both
H3K4me3 (activating) and H3K27me3 (repressive) histone marks in embryonic
stem cells; these became known as "bivalent" sites. The Roadmap Epigenome
project performed ChIP-seq on hundreds of normal primary tissues and cell
line results from the ENCODE project to generate a systematic catalog of
"chromatin states" alongside dozens of whole-genome bisulfite sequencing
experiments in the same tissues. We used both to generate a default atlas
of bivalent (Polycomb-associated and transcriptionally-poised) sites from
H9 human embryonic stem cells which retain low DNA methylation across normal
(non-placental) REMC tissues. In 2018, Zhou and Dinh (Nature Genetics) found
isolated (AT)CG(AT) sites, or "solo-WCGW" motifs, in common PMDs as the most
universal barometer of proliferation- and aging-associated methylation loss
in mammalian cells, so we use their solo-WCGW sites in common PMDs as the
default measure for hypomethylation. The resulting CpGindex is a vector of
length 3 for each sample: hypermethylation, hypomethylation, and their ratio.</p>
<p>We suggest fitting a model for the composition of bulk samples (tumor/normal,
tissue1/tissue2, or whatever is most appropriate) prior to drawing any firm
conclusions from the results of this function. For example, a mixture of
two-thirds normal tissue and one-third tumor tissue may produce the same or
lower degree of hyper/hypomethylation than high-tumor-content cell-free DNA
samples from the blood plasma of the same patient. Intuition is simply not
a reliable guide in such situations, which occur with some regularity. If
orthogonal estimates of purity/composition are available (flow cytometry,
ploidy, yield of filtered cfDNA), it is a Very Good Idea to include them.</p>
<p>The default for this function is to use the HMM-defined CpG islands from
Hao Wu's paper (Wu, Caffo, Jaffee, Irizarry &amp; Feinberg, Biostatistics 2010)
as generic "hypermethylation" targets inside of "bivalent" (H3K27me3+H3K4me3)
sites (identified in H9 embryonic stem cells &amp; unmethylated across normals),
and the solo-WCGW sites within common partially methylated domains from
Wanding Zhou and Huy Dinh's paper (Zhou, Dinh, et al, Nat Genetics 2018)
as genetic "hypomethylation" targets (as above, obvious caveats about tissue
specificity and user-supplied possibilities exist, but the defaults are sane
for many purposes, and can be exchanged for whatever targets a user wishes).</p>
<p>The function returns all three components of the "CpG index", comprised of
hyperCGI and hypoPMD (i.e. hyper, hypo, and their ratio). The PMD "score" is
a base-coverage-weighted average of losses to solo-WCGW bases within PMDs;
the PRC score is similarly base-coverage-weighted but across HMM CGI CpGs,
within polycomb repressor complex sites (by default, the subset of state 23
segments in the 25-state, 12-mark ChromImpute model for H9 which have less
than 10 percent CpG methylation across the CpG-island-overlapping segment in
all normal primary tissues and cells from the Reference Epigenome project).
By providing different targets and/or regions, users can customize as needed.</p>
<p>The return value is a CpGindex object, which is really just a DataFrame that
knows about the regions at which it was summarized, and reminds the user of
this when they implicitly call the <code>show</code> method on it.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
  <span class='no'>orig_bed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"MCF7_Cunha_chr11p15.bed.gz"</span>,
                          <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"biscuiteer"</span>)
  <span class='no'>orig_vcf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"MCF7_Cunha_header_only.vcf.gz"</span>,
                          <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"biscuiteer"</span>)
  <span class='no'>bisc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='readBiscuit.html'>readBiscuit</a></span>(<span class='kw'>BEDfile</span> <span class='kw'>=</span> <span class='no'>orig_bed</span>, <span class='kw'>VCFfile</span> <span class='kw'>=</span> <span class='no'>orig_vcf</span>,
                      <span class='kw'>merged</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'>Checking C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_chr11p15.bed.gz for import...</span></div><div class='output co'>#&gt; <span class='message'>Extracting sample names from C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_header_only.vcf.gz...</span></div><div class='output co'>#&gt; <span class='message'>C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_chr11p15.bed.gz does not have a header. Using VCF file header information to help set column names.</span></div><div class='output co'>#&gt; <span class='message'>Assuming unmerged data. Checking now...</span></div><div class='output co'>#&gt; <span class='message'> ...The file might be alright. Double check if you're worried.</span></div><div class='output co'>#&gt; <span class='message'>C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_chr11p15.bed.gz has 254147 indexed loci.</span></div><div class='output co'>#&gt; <span class='message'>C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_chr11p15.bed.gz looks valid for import.</span></div><div class='output co'>#&gt; <span class='message'>Reading unmerged input from C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_chr11p15.bed.gz...</span></div><div class='output co'>#&gt; <span class='message'>Excluding CpG sites with uniformly zero coverage...</span></div><div class='output co'>#&gt; <span class='message'>Loaded C:/Users/Hp/R/win-library/4.0/biscuiteer/extdata/MCF7_Cunha_chr11p15.bed.gz. Creating bsseq object...</span></div><div class='input'>
  <span class='no'>cpg</span> <span class='kw'>&lt;-</span> <span class='fu'>CpGindex</span>(<span class='no'>bisc</span>)</div><div class='output co'>#&gt; <span class='message'>Computing hypermethylation indices...</span></div><div class='output co'>#&gt; <span class='message'>Loading HMM_CpG_islands.hg19...</span></div><div class='output co'>#&gt; <span class='message'>Loading H9state23unmeth.hg19...</span></div><div class='output co'>#&gt; <span class='message'>Computing hypomethylation indices...</span></div><div class='output co'>#&gt; <span class='message'>Loading PMDs.hg19.rda from biscuiteerData...</span></div><div class='output co'>#&gt; <span class='message'>Loading Zhou_solo_WCGW_inCommonPMDs.hg19.rda from biscuiteerData...</span></div><div class='output co'>#&gt; <span class='message'>Computing indices...</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by "Jacob Morrison".</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


